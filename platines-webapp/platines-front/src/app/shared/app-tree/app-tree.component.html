<!--

    (c) Copyright 2017-2024, ANS. All rights reserved.

-->
<div [ngStyle]="{'border':border,'height':frameHeight}" class="treeFrame">
  <div class="tree-header">
    <span *ngIf="withHeader" class="tree-title">{{treeTitle|translate}}</span>
    <span class="tree-title-buttons">
      <button (click)="toggleAll()" class="btn-table titleIcon"
              matTooltip="{{'commons.actions.collapse_expand_all'|translate}}"
              [matTooltipClass]="'tooltip-inner'">
        <svg *ngIf="!this.expanded" aria-hidden="true" class="svg-icon svg-square-plus" focusable="false">
          <use xlink:href="svg-icons/icon-sprite.svg#square-plus"></use>
        </svg>
        <svg *ngIf="this.expanded" aria-hidden="true" class="svg-icon svg-square-less" focusable="false">
          <use xlink:href="svg-icons/icon-sprite.svg#square-less"></use>
        </svg>
      </button>
      <mat-icon *ngIf="allowMultipleSelection" matTooltip="{{'commons.tree.multipleSelectionHelp' | translate}}" [matTooltipClass]="'tooltip-inner'" class="titleIcon">
        <svg aria-hidden="true" class="svg-icon svg-question-circle" focusable="false">
          <use xlink:href="svg-icons/icon-sprite.svg#question-circle"></use>
        </svg>
      </mat-icon>
    </span>
  </div>
  <div #scrollableTreeContainer [ngStyle]="{'height': innerHeight}" class="mat-tree-container">
    <mat-tree [dataSource]="treeDataSource" [treeControl]="treeControl">
      <mat-nested-tree-node (click)="onNodeSelect(node,$event)" *matTreeNodeDef="let node" matTreeNodeToggle>
        <li>
          <div class="mat-tree-node">
            <span class="clickable-tree-node" [ngClass]="{'background-highlight':activeNodes.includes(node)}">{{node.name}}</span>
            <ng-container [ngTemplateOutletContext]="{$implicit:node,hidden: this.hidden.bind(this)}" [ngTemplateOutlet]="iconRef"></ng-container>
          </div>
        </li>
      </mat-nested-tree-node>
      <mat-nested-tree-node *matTreeNodeDef="let node; when: hasNestedChild">
        <li class="example-tree-container">
          <div (click)="onNodeSelect(node,$event)" class="mat-tree-node">
            <button mat-icon-button matTreeNodeToggle>
              <svg *ngIf="treeControl.isExpanded(node)" aria-hidden="true" class="svg-icon svg-angle-down" focusable="false">
                <use xlink:href="svg-icons/icon-sprite.svg#angle-down"></use>
              </svg>
              <svg *ngIf="!treeControl.isExpanded(node)" aria-hidden="true" class="svg-icon svg-angle-right" focusable="false">
                <use xlink:href="svg-icons/icon-sprite.svg#angle-right"></use>
              </svg>
            </button>
            <span [ngClass]="{'background-highlight':activeNodes.includes(node)}" class="example-tree-nested-node clickable-tree-node" style="cursor: pointer;">{{node.name}}</span>
            <ng-container [ngTemplateOutletContext]="{$implicit:node, hidden: this.hidden.bind(this)}" [ngTemplateOutlet]="iconRef"></ng-container>
          </div>

          <ul class="example-tree-nested-node">
            <div [class.invisible]="hidden(node)" class="nested-node">
              <ng-container matTreeNodeOutlet></ng-container>
            </div>
          </ul>
        </li>
      </mat-nested-tree-node>
    </mat-tree>
  </div>
</div>
